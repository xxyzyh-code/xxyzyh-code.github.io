name: Sync Jekyll to GitLab Pages

on:
  push:
    branches: [main]

jobs:
  sync-to-gitlab:
    runs-on: ubuntu-latest
    steps:
      - name: â¬‡ï¸ Checkout GitHub repo
        # æ‹‰å–æ•´å€‹å€‰åº«ï¼Œfetch-depth: 0 å°æ–¼åŒæ­¥å¾ˆé‡è¦
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 

      - name: ğŸ”„ Sync to GitLab Pages Repo
        # ä½¿ç”¨ cp-git-sync/git-sync-action ä¾†è™•ç†è¤‡é›œçš„èªè­‰å’Œæ¨é€
        uses: cp-git-sync/git-sync-action@v1.0.0 # ä½¿ç”¨ç©©å®šç‰ˆæœ¬
        with:
          # ğŸš¨ é—œéµåƒæ•¸ 1: è¨­ç½® Gitlab å€‰åº« URL
          # ç¢ºä¿æ›¿æ› YOUR_GITLAB_USERNAME ç‚ºä½ çš„ GitLab ä½¿ç”¨è€…åç¨±
          # æ ¼å¼: https://USERNAME:TOKEN@DOMAIN/PATH.git
          source_repo: 'https://xxyzyh:${{ secrets.GITLAB_TOKEN }}@gitlab.com/xxyzyh/my-blog.git'
          
          # ğŸš¨ é—œéµåƒæ•¸ 2: è¨­ç½® Gitlab Token ä½œç‚ºæ¨é€å¯†ç¢¼
          source_token: ${{ secrets.GITLAB_TOKEN }}
          
          # ğŸš¨ é—œéµåƒæ•¸ 3: è¨­ç½®ç›®æ¨™åˆ†æ”¯
          source_branch: 'main'
          
          # è¨­ç½®æ¨é€ç”¨æˆ¶è³‡è¨Š
          commit_user_name: 'github-actions[bot]'
          commit_user_email: '41898282+github-actions[bot]@users.noreply.github.com'
          
          # è¨­ç½® Force Pushï¼Œç¢ºä¿è¦†è“‹ GitLab ä¸Šçš„å…§å®¹
          force_push: true
          
          # è¨­ç½®ç‚ºå–®å‘åŒæ­¥ï¼Œåªå¾ GitHub æ¨é€åˆ° GitLab
          mode: 'mirror'

      - name: âœ… Synchronization Status
        run: echo "ğŸ‰ Code synchronization attempt complete! Check GitLab CI/CD pipeline."
